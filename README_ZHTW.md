# Replacer

此應用程式可用於管理和取代資料夾中包含的新舊版本檔案，提供清晰的檔案檢視，並突顯版本間的差異，使更新與比較變得簡單且高效。

git link: https://github.com/KaiJuY/Replacer

[English](README.md)

## 功能特色

- 📁 **雙資料夾比對** - 並排比較新舊資料夾結構
- 🔍 **檔案差異檢視器** - 以顏色標示新增（綠色）和刪除（紅色）的內容
- ✅ **選擇性更新** - 使用勾選框選擇要更新的檔案
- 🔄 **兩種更新模式：**
  - **完整更新** - 完全取代檔案
  - **僅新增行** - 只新增新的內容行，不修改現有內容
- 💾 **自動備份** - 更新前自動建立帶時間戳記的備份
- 📄 **PDF 報告產生** - 自動產生包含差異的更新報告
- 👤 **操作者追蹤** - OP ID 欄位用於責任歸屬和報告追蹤
- ⚙️ **設定檔支援** - 透過 `config.ini` 預先設定檔案選擇

## 系統需求

- Python 3.8 或更高版本
- 相依套件（透過 requirements.txt 安裝）：
  - tkinter（通常隨 Python 安裝）
  - reportlab

## 安裝方式

1. 複製儲存庫：
```bash
git clone https://github.com/KaiJuY/Replacer.git
cd Replacer
```

2. 安裝相依套件：
```bash
pip install -r requirements.txt
```

## 執行方式

```bash
python main.py
```

## GUI 操作指南

![alt text](Aserts/image.png)

### 頂部按鈕區

- **選擇舊資料夾**

    選擇包含您想要取代的檔案的資料夾（目標資料夾）。

- **選擇新資料夾**

    選擇包含更新檔案的資料夾（來源資料夾）。

- **OP 欄位**

    輸入您的操作者 ID。此欄位為必填，必須填寫後才能執行更新。OP ID 會被包含在 PDF 報告中以便追蹤。

- **選擇所有檔案**

    快速勾選檔案樹中的所有檔案以進行更新。

- **依設定選擇**

    從 `config.ini` 載入檔案選擇設定。這允許您預先設定哪些檔案應該被預設選取。

### 檔案瀏覽區（左側面板）

左側窗格顯示所選資料夾中所有檔案的階層樹狀檢視：
- 📁 資料夾可透過點擊箭頭（▶️/🔽）展開/收合
- 📄 檔案以勾選框列出
- 點擊任何檔案可在比較區檢視其差異
- 勾選資料夾會自動勾選/取消勾選其中的所有檔案

### 檔案比較區（右側面板）

在檔案瀏覽器中選擇檔案後，此區域會顯示新舊版本之間的差異：
- **紅色底色 (-)** 的行表示在新版本中被移除的內容
- **綠色底色 (+)** 的行表示在新版本中新增的內容
- 未變更的行會正常顯示以提供上下文

### 更新按鈕（底部）

- **更新**

    執行完整檔案取代。舊資料夾中被選取的檔案將完全被新資料夾中對應的版本取代。
    - 更新前自動建立備份
    - 完成後產生 PDF 報告

- **僅更新新增行**

    執行部分更新。只從新檔案新增全新的內容行到舊檔案，同時保留現有內容（即使已被修改）。
    - 當您想要合併新內容而不覆蓋變更時很有用
    - 更新前自動建立備份
    - 完成後產生 PDF 報告

### 檔案選擇框

- **已勾選** - 檔案將被更新
- **未勾選** - 檔案將被保留（不變更）

## 設定檔（config.ini）

在 `main.py` 的相同目錄中建立 `config.ini` 檔案以預先設定檔案選擇：

```ini
[Files]
file1.txt = True
file2.py = False
folder/file3.js = True
```

## 備份與報告

- **備份**：自動在舊資料夾的上層目錄建立，命名格式為：`{資料夾名稱}_backup_{YYYYMMDD_HHMMSS}`
- **PDF 報告**：儲存在 `pdf/` 資料夾中，命名格式為：`{YYYYMMDD_HHMMSS}_{OP_ID}.pdf`
  - 包含操作者 ID、時間戳記以及所有更新檔案的詳細差異
- **Report範例** : 
![alt text](Aserts/report.png)

## 疑難排解

- **按鈕被停用**：請確保在 OP 欄位中輸入了 OP ID
- **權限錯誤**：應用程式會在複製前自動修改唯讀檔案的權限
- **差異中的 Unicode**：包含中文字元或特殊符號的檔案在 PDF 報告中會顯示「Diff omitted」以避免編碼問題

## 已完成功能

- ✅ 部分更新功能（僅新增行）
- ✅ 包含更新詳情的 PDF 報告產生
- ✅ 基於差異的預設檔案選擇
- ✅ 基於設定的檔案選擇
- ✅ 自動備份系統
- ✅ 操作者 ID 追蹤